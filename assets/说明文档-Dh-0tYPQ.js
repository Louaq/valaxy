import{_ as o}from"./ValaxyMain.vue_vue_type_style_index_0_lang-C5JMZwJJ.js";import{c as g,w as a,f as y,e as c,p as r,o as E,g as i,h as s,r as n}from"./app-CftBLVN4.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-BnQoO184.js";import"./YunCard.vue_vue_type_script_setup_true_lang-BpvS834H.js";import"./index-C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-B2zv5Aao.js";import"./post-DkFQf5pI.js";const _={__name:"说明文档",setup(u,{expose:p}){const t=JSON.parse('{"title":"说明文档","description":"","frontmatter":{"title":"说明文档","date":"2024-08-19 12:00:00","expires":"2024-08-21 13:00:00","thumbnail":"https://yangyang666.oss-cn-chengdu.aliyuncs.com/images/%E6%8A%A5%E7%BA%B8%E5%A2%99%E5%8F%AF%E7%88%B1%E5%A5%B3%E5%AD%A9%E8%90%A8%E5%8B%92%E8%8A%AC%E5%A6%AE4K%E5%A3%81%E7%BA%B83840_2400_%E5%BD%BC%E5%B2%B8%E5%9B%BE%E7%BD%91.jpg","tags":["人工智能","论文","python"],"categories":["YOLO"],"top":1},"headers":[{"level":2,"title":"安装Python","slug":"安装python","link":"#安装python","children":[]},{"level":2,"title":"安装anaconda","slug":"安装anaconda","link":"#安装anaconda","children":[]},{"level":2,"title":"安装Pycharm","slug":"安装pycharm","link":"#安装pycharm","children":[]},{"level":2,"title":"YOLOv8目录结构介绍","slug":"yolov8目录结构介绍","link":"#yolov8目录结构介绍","children":[]},{"level":2,"title":"安装项目的环境（非常重要）","slug":"安装项目的环境-非常重要","link":"#安装项目的环境-非常重要","children":[{"level":3,"title":"anaconda虚拟环境","slug":"anaconda虚拟环境","link":"#anaconda虚拟环境","children":[]},{"level":3,"title":"使用虚拟环境","slug":"使用虚拟环境","link":"#使用虚拟环境","children":[]}]},{"level":2,"title":"训练脚本train.py","slug":"训练脚本train-py","link":"#训练脚本train-py","children":[]},{"level":2,"title":"开始训练","slug":"开始训练","link":"#开始训练","children":[]},{"level":2,"title":"训练结果","slug":"训练结果","link":"#训练结果","children":[]},{"level":2,"title":"总结","slug":"总结","link":"#总结","children":[]},{"level":2,"title":"经验之谈","slug":"经验之谈","link":"#经验之谈","children":[{"level":3,"title":"针对一些报错的解决办法在这里说一下","slug":"针对一些报错的解决办法在这里说一下","link":"#针对一些报错的解决办法在这里说一下","children":[]}]}],"relativePath":"pages/posts/说明文档.md","path":"/home/runner/work/valaxy/valaxy/pages/posts/说明文档.md","lastUpdated":1728120338000}'),h=c(),e=t.frontmatter||{};return h.meta.frontmatter=Object.assign(h.meta.frontmatter||{},t.frontmatter||{}),r("pageData",t),r("valaxy:frontmatter",e),globalThis.$frontmatter=e,p({frontmatter:{title:"说明文档",date:"2024-08-19 12:00:00",expires:"2024-08-21 13:00:00",thumbnail:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/images/%E6%8A%A5%E7%BA%B8%E5%A2%99%E5%8F%AF%E7%88%B1%E5%A5%B3%E5%AD%A9%E8%90%A8%E5%8B%92%E8%8A%AC%E5%A6%AE4K%E5%A3%81%E7%BA%B83840_2400_%E5%BD%BC%E5%B2%B8%E5%9B%BE%E7%BD%91.jpg",tags:["人工智能","论文","python"],categories:["YOLO"],top:1}}),(l,k)=>{const d=o;return E(),g(d,{frontmatter:y(e)},{"main-content-md":a(()=>k[0]||(k[0]=[i("blockquote",null,[i("p",null,"这篇文档主要介绍《基于YOLOv8的农田病虫害检测与分析》的代码实现部分，整篇论文的目的主要是改进YOLOv8的网络结构，使其在检测病虫害的精度和实时性上有所提升。接下来，我将介绍如何从零开始搭建起本项目。")],-1),i("h2",{id:"安装python",tabindex:"-1"},[s("安装Python "),i("a",{class:"header-anchor",href:"#安装python","aria-label":'Permalink to "安装Python"'},"​")],-1),i("p",null,[s("到python的官方网站："),i("a",{href:"https://www.python.org/",target:"_blank",rel:"noreferrer"},"https://www.python.org/"),s("下载，安装")],-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-10-42.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"安装完成后，在命令行窗口运行：python，查看安装的结果，如下图：",-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-14-22.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"至此，Python安装完成，接下来还需要安装anaconda，这是一个python虚拟环境，特别适合管理python的环境。",-1),i("h2",{id:"安装anaconda",tabindex:"-1"},[s("安装anaconda "),i("a",{class:"header-anchor",href:"#安装anaconda","aria-label":'Permalink to "安装anaconda"'},"​")],-1),i("p",null,[s("到anaconda的官方网站："),i("a",{href:"https://www.anaconda.com/download/success",target:"_blank",rel:"noreferrer"},"https://www.anaconda.com/download/success"),s("下载，并安装：")],-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-17-10.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"安装成功后，会在开始菜单出现如下图所示：",-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-19-17.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"anaconda安装完成，接下来安装pycharm，主要用来编写代码。",-1),i("h2",{id:"安装pycharm",tabindex:"-1"},[s("安装Pycharm "),i("a",{class:"header-anchor",href:"#安装pycharm","aria-label":'Permalink to "安装Pycharm"'},"​")],-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-23-47.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"学生可以申请教育版",-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-24-59.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"支持，所有的软件安装完成。",-1),i("h2",{id:"yolov8目录结构介绍",tabindex:"-1"},[s("YOLOv8目录结构介绍 "),i("a",{class:"header-anchor",href:"#yolov8目录结构介绍","aria-label":'Permalink to "YOLOv8目录结构介绍"'},"​")],-1),i("p",null,"首先介绍整个项目的目录：",-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-27-47.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-28-07.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"和原来的YOLOv8相比，根目录新增一些训练的脚本和测试的脚本，比如train.py和Detect.py，当然也可以直接通过命令行的方式来实现，两者效果都是一样的。",-1),i("blockquote",null,[i("p",null,[i("strong",null,"重点是ultralytics/nn目录，所有的改进模块都是在这里进行，在这里我新建了一个Addmodules的目录，里面是改进的各种模块，包括主干网络，颈部网络和检测头的改进。")])],-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-36-15.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"需要修改的部分我都已经作了修改，不用再做其他的改动",-1),i("blockquote",null,[i("p",null,[i("strong",null,"还有一个重要的目录：ultralytics/cfg/models/Add，这里面放的都是yaml文件，其中改进的yaml文件都已经写好，不需要改动。")])],-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-38-32.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"以下是一个yaml文件的示例，其它的都是类似的结构，只是参数不同：",-1),i("h2",{id:"安装项目的环境-非常重要",tabindex:"-1"},[s("安装项目的环境（非常重要） "),i("a",{class:"header-anchor",href:"#安装项目的环境-非常重要","aria-label":'Permalink to "安装项目的环境（非常重要）"'},"​")],-1),i("blockquote",null,[i("p",null,"环境配置非常重要，我当时配环境换了一周左右的时间，中间经历了各种报错，软件包不兼容的问题和显卡驱动匹配的问题，总之就是不好搞。为了方面复现工作，我已经把anaconda的环境导出为environment.yml，位于项目的根目录里面，创建虚拟环境的时候直接使用就可以")],-1),i("h3",{id:"anaconda虚拟环境",tabindex:"-1"},[s("anaconda虚拟环境 "),i("a",{class:"header-anchor",href:"#anaconda虚拟环境","aria-label":'Permalink to "anaconda虚拟环境"'},"​")],-1),i("p",null,"再anaconda prompt终端输入conda env create -f environment.yml，就可以根据environment.yml文件创建虚拟环境，创建好后，通过conda env list查看环境是否存在，如下图所示就表明创建成功：",-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_16-35-14.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"如果安装的时候出现torch相关的错误，大概率是你的显卡驱动和这里面的torch包版本不匹配，这个问题需要自行修改即可，网上关于这方面的资料很多。",-1),i("h3",{id:"使用虚拟环境",tabindex:"-1"},[s("使用虚拟环境 "),i("a",{class:"header-anchor",href:"#使用虚拟环境","aria-label":'Permalink to "使用虚拟环境"'},"​")],-1),i("p",null,"虚拟环境创建完成之后，就可以在pycharm中使用，点击右下角，切换conda环境，选择刚才创建的虚拟环境。如果到了这一步还没有报错的话，恭喜你，已经完成了80%的工作。",-1),i("p",null,"运行Detect.py脚本，测试检测效果，如果没有报错，接下来就是训练模型。",-1),i("h2",{id:"训练脚本train-py",tabindex:"-1"},[s("训练脚本train.py "),i("a",{class:"header-anchor",href:"#训练脚本train-py","aria-label":'Permalink to "训练脚本train.py"'},"​")],-1),i("p",null,"找到根目录的train.py文件，注释已经写的很清楚，如下图：",-1),i("div",{class:"language-py vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"py"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," warnings")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"warnings.filterwarnings("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'ignore'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ultralytics "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," YOLO")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"if"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," __name__"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '__main__'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    model "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," YOLO("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'yolov8-HSFPN.yaml'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    # model.load('yolov8n.pt') # 是否加载预训练权重,科研不建议大家加载否则很难提升精度")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    model.train("),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"data"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"r"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#DBEDFF"}},"D:/Downloads/YOLOv8/datasets/data"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"."),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#DBEDFF"}},"yaml"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                # 如果大家任务是其它的'ultralytics/cfg/default.yaml'找到这里修改task可以改成detect, segment, classify, pose")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                cache"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"False"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                imgsz"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"640"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                epochs"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"150"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                single_cls"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"False"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",  "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 是否是单类别检测")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                batch"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                close_mosaic"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                workers"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                device"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'0'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                optimizer"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'SGD'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# using SGD")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                # resume='runs/train/exp21/weights/last.pt', # 如过想续训就设置last.pt的地址")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                amp"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"True"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",  "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 如果出现训练损失为Nan可以关闭amp")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                project"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'runs/train'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                name"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'exp'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                )")])])]),i("button",{class:"collapse"})],-1),i("p",null,"model = YOLO('yolov8-HSFPN.yaml')，把里面的yaml文件换成自己的yaml文件，我这里用的是yolov8-HSFPN.yaml，data=r’D:/Downloads/YOLOv8/datasets/data.yaml，同理，换成自己数据集的yaml文件，我这里的数据集是yolo格式。其它的参数可以按照自己的任务自行调整。",-1),i("p",null,"还有一个检测的脚本，Detect.py:",-1),i("div",{class:"language-python vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"python"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," warnings")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"warnings.filterwarnings("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'ignore'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ultralytics "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," YOLO")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"if"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," __name__"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '__main__'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    model "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," YOLO("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'D:/Downloads/YOLOv8/result/result_8_HSFPN/train/exp/weights/best.pt'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# select your model.pt path")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    model.predict("),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"source"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'D:/Downloads/YOLOv8/ultralytics/assets'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                  imgsz"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"640"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                  project"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'runs/detect'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                  name"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'exp'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"                  save"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"True"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                )")])])]),i("button",{class:"collapse"})],-1),i("p",null,"同理，把best.pt换成你自己训练好的模型，source里面输入检测图片的路径，运行该脚本就可以开始检测，结果保存在runs/detect目录。",-1),i("h2",{id:"开始训练",tabindex:"-1"},[s("开始训练 "),i("a",{class:"header-anchor",href:"#开始训练","aria-label":'Permalink to "开始训练"'},"​")],-1),i("p",null,"准备好数据集，最好是yolo格式的，我的数据集项目里自带了，不需要重新下载：",-1),i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-55-44.png",style:{zoom:"67%"}},null,-1),i("p",null,"datasets目录里面就是我的数据集：有train，test，valid三个目录，分别存放训练集，测试集和验证集的图像和标签：",-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-58-01.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_15-58-32.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"准备这些之后，运行train.py文件，开始训练。如果报错的话，请自行上网查找，无非就是找不到数据集，某个包的版本不对，或者是GPU用不了，只能用CPU。",-1),i("h2",{id:"训练结果",tabindex:"-1"},[s("训练结果 "),i("a",{class:"header-anchor",href:"#训练结果","aria-label":'Permalink to "训练结果"'},"​")],-1),i("blockquote",null,[i("p",null,"训练结果会保存在runs/train目录下，exp1,exp2,exp3的顺序，表示每一次的训练结果。")],-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_16-04-37.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"上图就是训练完成后目录的结构，weights目录里面就是我们需要的模型：best.pts是效果最好的，最后也是需要这个，last.pt是最后一次的训练结果。",-1),i("figure",null,[i("img",{src:"https://yangyang666.oss-cn-chengdu.aliyuncs.com/typoraImages/Snipaste_2024-05-23_16-05-47.png",alt:"",loading:"lazy",decoding:"async"})],-1),i("h2",{id:"总结",tabindex:"-1"},[s("总结 "),i("a",{class:"header-anchor",href:"#总结","aria-label":'Permalink to "总结"'},"​")],-1),i("p",null,[i("strong",null,"整个项目的改进工作我已经做好，复现的话只需装好对应的环境，修改train.py的参数，运行train.py就可以开始训练；修改Detect.py的参数，就可以检测。目前项目只针对检测任务，对于分割和分类没有做改进。")],-1),i("h2",{id:"经验之谈",tabindex:"-1"},[s("经验之谈 "),i("a",{class:"header-anchor",href:"#经验之谈","aria-label":'Permalink to "经验之谈"'},"​")],-1),i("p",null,[i("strong",null,"（1）以下为两个重要库的版本，必须对应下载，否则会报错")],-1),i("blockquote",null,[i("p",null,"python == 3.9.7 pytorch == 1.12.1 timm == 0.9.12 # 此安装包必须要 mmcv-full == 1.6.2 # 不安装此包部分关于dyhead的代码运行不了以及Gold-YOLO")],-1),i("p",null,[i("strong",null,"（2）mmcv-full会安装失败是因为自身系统的编译工具有问题，也有可能是环境之间安装的有冲突")],-1),i("pre",null,[i("code",null,`推荐大家离线安装的形式,下面的地址中大家可以找找自己的版本,下载到本地进行安装。
https://download.openmmlab.com/mmcv/dist/cu111/torch1.8.0/index.html
https://download.openmmlab.com/mmcv/dist/index.html
`)],-1),i("p",null,[i("strong",null,"（3）basicsr安装失败原因,通过pip install basicsr 下载如果失败,大家可以去百度搜一下如何换下载镜像源就可以修复")],-1),i("h3",{id:"针对一些报错的解决办法在这里说一下",tabindex:"-1"},[s("针对一些报错的解决办法在这里说一下 "),i("a",{class:"header-anchor",href:"#针对一些报错的解决办法在这里说一下","aria-label":'Permalink to "针对一些报错的解决办法在这里说一下"'},"​")],-1),i("p",null,[i("strong",null,"(1)训练过程中loss出现Nan值."),s(" 可以尝试关闭AMP混合精度训练.")],-1),i("p",null,[i("strong",null,"(2)多卡训练问题,修改模型以后不能支持多卡训练可以尝试下面的两行命令行操作，两个是不同的操作，是代表不同的版本现尝试第一个不行用第二个")],-1),i("pre",null,[i("code",null,`python -m torch.distributed.run --nproc_per_node 2 train.py
python -m torch.distributed.launch --nproc_per_node 2 train.py
`)],-1),i("p",null,[i("strong",null,"(3) 针对运行过程中的一些报错解决"),s(" 1.如果训练的过程中验证报错了(主要是一些形状不匹配的错误这是因为验证集的一些特殊图片导致) 找到ultralytics/models/yolo/detect/train.py的DetectionTrainer class中的build_dataset函数中的rect=mode == 'val’改为rect=False")],-1),i("div",{class:"language-py vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"py"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"推理的时候运行detect.py文件报了形状不匹配的错误")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"找到ultralytics"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"engine"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"predictor.py找到函数def pre_transform("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"self"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", im),在LetterBox中的auto改为False")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"训练的过程中报错类型不匹配的问题")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"找到"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'ultralytics/engine/validator.py'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"文件找到 "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'class BaseValidator:'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 然后在其"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'__call__'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"中")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"self"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".args.half "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," self"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".device.type "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'cpu'"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  # force FP16 val during training的一行代码下面加上self.args.half = False")])])]),i("button",{class:"collapse"})],-1),i("p",null,[i("strong",null,"(4) 针对yaml文件中的nc修改"),s(" 不用修改，模型会自动根据你数据集的配置文件获取。 这也是模型打印两次的区别，第一次打印出来的就是你选择模型的yaml文件结构，第二次打印的就是替换了你数据集的yaml文件，模型使用的是第二种。")],-1),i("p",null,[i("strong",null,"(5) 针对环境的问题"),s(" 环境的问题每个人遇见的都不一样，可自行上网查找。")],-1),i("p",null,"[]:",-1)])),"main-header":a(()=>[n(l.$slots,"main-header")]),"main-header-after":a(()=>[n(l.$slots,"main-header-after")]),"main-nav":a(()=>[n(l.$slots,"main-nav")]),"main-content":a(()=>[n(l.$slots,"main-content")]),"main-content-after":a(()=>[n(l.$slots,"main-content-after")]),"main-nav-before":a(()=>[n(l.$slots,"main-nav-before")]),"main-nav-after":a(()=>[n(l.$slots,"main-nav-after")]),comment:a(()=>[n(l.$slots,"comment")]),footer:a(()=>[n(l.$slots,"footer")]),aside:a(()=>[n(l.$slots,"aside")]),"aside-custom":a(()=>[n(l.$slots,"aside-custom")]),default:a(()=>[n(l.$slots,"default")]),_:3},8,["frontmatter"])}}};export{_ as default};
